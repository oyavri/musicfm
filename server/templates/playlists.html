{% extends "base.html" %} 
{% block content %}
<div class="playlists-container">
  <h1>Your Playlists</h1>

  <!-- Create Playlist Form -->
  <form method="POST" class="create-playlist-form">
    <input type="hidden" name="action" value="create_playlist" />
    <input
      type="text"
      name="playlist_name"
      placeholder="New Playlist Name"
      required
    />
    <button type="submit">Create Playlist</button>
  </form>

  <!-- Playlists -->
  {% if playlists|length > 0 %}
  <ul>
    {% for playlist in playlists %}
    <li>
      <h2>{{ playlist.name }}</h2>
      <!-- Delete Playlist -->
       {% if playlist.name %}
      <form method="POST" class="delete-playlist-form">
        <input type="hidden" name="action" value="delete_playlist" />
        <input type="hidden" name="playlist_id" value="{{ playlist.id }}" />
        <button type="submit">Delete Playlist</button>
      </form>
      {% endif %}
      <!-- Tracks in Playlist -->
      <ul>
        {% for track in playlist.tracks %}
        <li>
          {{ track.name }}
          <form method="POST" class="remove-track-form">
            <input type="hidden" name="action" value="remove" />
            <input type="hidden" name="playlist_id" value="{{ playlist.id }}" />
            <input type="hidden" name="track_id" value="{{ track.id }}" />
            <button type="submit">Remove</button>
          </form>
        </li>
        {% endfor %}
      </ul>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p>No playlists available. Create one to get started!</p>
  {% endif %}

  <!-- Search Tracks -->
  <form method="GET" action="/playlists" class="search-tracks-form">
    <input
      type="text"
      name="q"
      placeholder="Search for tracks..."
      value="{{ search_query }}"
    />
    <button type="submit">Search</button>
  </form>

  <!-- Search Results -->
  {% if search_results %}
  <div class="search-results">
    <h2>Search Results</h2>
    <ul>
      {% for track in search_results %}
      <li>
        {{ track.name }}
        <form method="POST" class="add-track-form">
          <input type="hidden" name="action" value="add" />
          <input type="hidden" name="track_id" value="{{ track.id }}"
          />
          <!-- Dropdown to select the playlist -->
          <select name="playlist_id" required>
            <option value="" disabled selected>Select Playlist</option>
            {% for playlist in playlists %}
            <option value="{{ playlist.id }}">{{ playlist.name }}</option>
            {% endfor %}
          </select>
          <button type="submit">Add to Playlist</button>
        </form>
      </li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
</div>
{% endblock %}
